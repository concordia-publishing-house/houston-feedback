<% content_for :title do %>
<h1 class="project-banner space-below">
  <small>comments for</small>
  All Projects
  
  <%= render partial: "projects/keyboard_shortcuts" %>
</h1>
<% end %>

<div id="feedback" class="row-fluid">
  <div class="feedback-search callout callout-slim callout-banner">
    <form id="search_feedback">
      <%= search_field_tag "q", @q, autocomplete: "off" %>
    </form>
  </div>
  
  <p id="search_report" class="feedback-search-report"></p>
  
  <div id="tags_report" class="feedback-tags-report"></div>
  <div id="results" class="span6 infinite-scroll"></div>
  <div id="feedback_edit" class="span6"></div>
</div>

<% content_for :javascripts do -%>
  <script type="text/javascript">
    $(function() {
      var comments = <%=raw Houston::Feedback::CommentPresenter.new(current_ability, @comments).to_json %>;
      window.commentsView = new Houston.Feedback.CommentsView({
        el: document.getElementById('feedback'),
        infiniteScroll: true,
        tagsByProject: <%=raw @tags_by_project.to_json %>,
        comments: new Houston.Feedback.Comments(comments, {parse: true}),
      });
      commentsView.render();
    });
  </script>
<% end -%>
